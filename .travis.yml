language: java
sudo: required
services:
- docker
jdk: oraclejdk8
install: gradle assemble
script: gradle check

after_success:
  - docker login -e $DOCKER_EMAIL -u $DOCKER_USERNAME -p $DOCKER_PASSWORD
  - export REPO=arne2/fapcrawler
  - export TAG=`if [ "$TRAVIS_BRANCH" == "master" ]; then echo "latest"; else echo $TRAVIS_BRANCH ; fi`
  - docker build -f dockerfile -t $REPO:$COMMIT .
  - docker tag $REPO:$COMMIT $REPO:$TAG
  - docker tag $REPO:$COMMIT $REPO:travis-$TRAVIS_BUILD_NUMBER
  - if [ "$TRAVIS_BRANCH" == "master" ] && [ "$TRAVIS_PULL_REQUEST" == "false" ]; then docker push $REPO ; fi

notifications:
  email: false
env:
  global:
  - secure: HLHKdF3z0SQE0OWNgeccexA6gpbEEmAmGnmZN2n6g4Cihx0fc0H8Sf4t8fawBbpJ0Ihf4MhAwyi5a8KNFav1Bi3m4RZnN9QArwwTYRBw8s5QTcpqt2FbM63r4YOiWJPfd77AzRWJS4ngokPnAFgVUE+M7gWhnBvXWMH++Hr2sl0=
  - secure: HLHKdF3z0SQE0OWNgeccexA6gpbEEmAmGnmZN2n6g4Cihx0fc0H8Sf4t8fawBbpJ0Ihf4MhAwyi5a8KNFav1Bi3m4RZnN9QArwwTYRBw8s5QTcpqt2FbM63r4YOiWJPfd77AzRWJS4ngokPnAFgVUE+M7gWhnBvXWMH++Hr2sl0=
  - secure: ISLC8U/JPmRvWWa8FX3UvVYvQtB7VUjvwRQeSE7hr2YV4go55uLN8SnbjON6y5qYKtx4OBA0h4dtPxEFbVGbfon3iA+uAZ6DesScwDJdIc5B893fXYGoMSIN4kLC3g15dRGiXXXdDuK4J2yt0fR2X6Y4YAkWtiy0FkdPsdc7hJ0=



